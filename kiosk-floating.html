<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>AIã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥ Kiosk | GBase</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: 'Noto Sans JP', sans-serif;
            background: #000;
        }

        /* Bot iframe - full screen */
        #bot-frame {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            z-index: 1;
        }

        /* Floating overlay panel - matches Playwright design */
        #kiosk-overlay {
            position: fixed;
            left: 10px;
            top: 70px;
            bottom: 70px;
            width: 280px;
            background: rgba(26, 26, 46, 0.97);
            backdrop-filter: blur(10px);
            z-index: 99999;
            display: flex;
            flex-direction: column;
            transform: translateX(0);
            transition: transform 0.3s ease;
            box-shadow: 0 4px 30px rgba(0,0,0,0.5);
            overflow: hidden;
            border-radius: 16px;
        }

        #kiosk-overlay.hidden {
            transform: translateX(calc(-100% - 20px));
        }

        /* Header */
        #kiosk-header {
            padding: 12px 16px;
            background: rgba(255,255,255,0.05);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #kiosk-header h1 {
            color: #fff;
            font-size: 14px;
            font-weight: 700;
            margin: 0;
        }

        #kiosk-header p {
            color: rgba(255,255,255,0.5);
            font-size: 11px;
            margin: 0;
        }

        /* Language selector */
        #lang-selector {
            margin-left: auto;
            padding: 6px 10px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            color: #fff;
            font-size: 12px;
            cursor: pointer;
            outline: none;
        }

        #lang-selector:hover {
            background: rgba(255,255,255,0.15);
        }

        #lang-selector option {
            background: #1a1a2e;
            color: #fff;
        }

        /* Zone buttons grid */
        #kiosk-zones {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            padding: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .kiosk-zone-btn {
            padding: 10px 8px;
            border-radius: 10px;
            border: 2px solid transparent;
            background: rgba(255,255,255,0.08);
            color: #fff;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            text-align: center;
        }

        .kiosk-zone-btn .zone-icon {
            font-size: 20px;
        }

        .kiosk-zone-btn .zone-label {
            font-size: 11px;
            opacity: 0.9;
        }

        .kiosk-zone-btn:hover {
            background: rgba(255,255,255,0.15);
            transform: scale(1.02);
        }

        .kiosk-zone-btn.active {
            background: var(--zone-color);
            border-color: rgba(255,255,255,0.3);
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        /* Prompts list */
        #kiosk-prompts {
            flex: 1;
            padding: 12px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .kiosk-prompt-btn {
            width: 100%;
            padding: 12px 14px;
            border-radius: 10px;
            border: 1px solid rgba(255,255,255,0.12);
            background: rgba(255,255,255,0.05);
            color: #fff;
            font-size: 13px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .kiosk-prompt-btn:hover {
            background: rgba(255,255,255,0.12);
            border-color: var(--zone-color);
        }

        .kiosk-prompt-btn:active {
            transform: scale(0.98);
        }

        .kiosk-prompt-btn.copied {
            background: #22c55e;
            border-color: #22c55e;
        }

        .kiosk-prompt-btn .arrow {
            opacity: 0.4;
            font-size: 12px;
        }

        .kiosk-prompt-btn:hover .arrow {
            opacity: 1;
        }

        /* Footer */
        #kiosk-footer {
            padding: 12px;
            background: rgba(0,0,0,0.2);
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        #kiosk-hint {
            text-align: center;
            color: rgba(255,255,255,0.5);
            font-size: 11px;
            line-height: 1.5;
        }

        #kiosk-hint .icon {
            font-size: 14px;
            vertical-align: middle;
        }

        #kiosk-status {
            text-align: center;
            color: rgba(255,255,255,0.3);
            font-size: 10px;
            margin-top: 8px;
        }

        /* Toggle button - desktop only */
        #kiosk-toggle-btn {
            position: fixed;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 99998;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            font-size: 26px;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(102, 126, 234, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        #kiosk-toggle-btn.visible {
            opacity: 1;
            pointer-events: auto;
        }

        #kiosk-toggle-btn:hover {
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.7);
        }

        /* Mobile peek tab - shown when drawer is hidden */
        #kiosk-peek-tab {
            display: none;
        }

        /* Toast notification */
        #toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(34, 197, 94, 0.95);
            color: white;
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 500;
            z-index: 100000;
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        #toast.show {
            opacity: 1;
        }

        /* Loading state */
        #loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #1a1a2e;
            z-index: 100001;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease;
        }

        #loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.2);
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        #loading-overlay p {
            color: rgba(255,255,255,0.7);
            margin-top: 16px;
            font-size: 14px;
        }

        /* Back button in header */
        #back-btn {
            padding: 6px 10px;
            border-radius: 8px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: rgba(255,255,255,0.8);
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
            text-decoration: none;
            transition: all 0.2s;
            margin-left: auto;
        }

        #back-btn:hover {
            background: rgba(255,255,255,0.2);
            color: #fff;
        }

        /* Mobile responsive - Bottom drawer design */
        @media (max-width: 768px) {
            #kiosk-overlay {
                left: 0;
                right: 0;
                top: auto;
                bottom: 0;
                width: 100%;
                max-width: none;
                border-radius: 20px 20px 0 0;
                max-height: 55vh;
                transform: translateY(0);
            }

            #kiosk-overlay.hidden {
                transform: translateY(100%);
            }

            /* Drag handle */
            #kiosk-header::before {
                content: '';
                display: block;
                width: 40px;
                height: 4px;
                background: rgba(255,255,255,0.3);
                border-radius: 2px;
                margin: 0 auto 8px;
            }

            #kiosk-header {
                padding: 12px 16px 8px;
                flex-direction: column;
                align-items: stretch;
            }

            #kiosk-header > div {
                display: flex;
                align-items: center;
                justify-content: space-between;
            }

            #kiosk-header h1 {
                font-size: 13px;
            }

            #kiosk-header p {
                display: none;
            }

            #back-btn {
                margin-left: 0;
                padding: 5px 10px;
                font-size: 11px;
            }

            /* Horizontal scrolling zones */
            #kiosk-zones {
                display: flex;
                flex-wrap: nowrap;
                overflow-x: auto;
                gap: 8px;
                padding: 8px 12px;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none;
            }

            #kiosk-zones::-webkit-scrollbar {
                display: none;
            }

            .kiosk-zone-btn {
                flex: 0 0 auto;
                padding: 8px 14px;
                flex-direction: row;
                gap: 6px;
                min-width: auto;
            }

            .kiosk-zone-btn .zone-icon {
                font-size: 18px;
            }

            .kiosk-zone-btn .zone-label {
                font-size: 12px;
            }

            /* Prompts in 2 columns */
            #kiosk-prompts {
                padding: 10px 12px;
                gap: 8px;
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                flex: none;
                max-height: 30vh;
                overflow-y: auto;
            }

            .kiosk-prompt-btn {
                padding: 10px 12px;
                font-size: 12px;
            }

            #kiosk-footer {
                padding: 10px 12px;
                padding-bottom: max(10px, env(safe-area-inset-bottom));
            }

            #kiosk-hint {
                font-size: 11px;
            }

            #kiosk-status {
                display: none;
            }

            /* Hide desktop toggle button on mobile */
            #kiosk-toggle-btn {
                display: none !important;
            }

            /* Mobile peek tab - minimal handle */
            #kiosk-peek-tab {
                display: flex;
                position: fixed;
                left: 50%;
                bottom: 0;
                transform: translateX(-50%);
                z-index: 99998;
                width: 60px;
                height: 20px;
                padding-bottom: env(safe-area-inset-bottom);
                background: rgba(26, 26, 46, 0.9);
                border-radius: 10px 10px 0 0;
                border: none;
                cursor: pointer;
                box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
                align-items: center;
                justify-content: center;
                opacity: 0;
                pointer-events: none;
                transition: all 0.3s ease;
            }

            #kiosk-peek-tab.visible {
                opacity: 1;
                pointer-events: auto;
            }

            #kiosk-peek-tab .handle {
                width: 32px;
                height: 4px;
                background: rgba(255,255,255,0.5);
                border-radius: 2px;
            }

            #kiosk-peek-tab:active .handle {
                background: rgba(255,255,255,0.8);
            }

            #kiosk-peek-tab .label {
                display: none;
            }

            /* Toast position */
            #toast {
                bottom: 80px;
            }
        }
    </style>
</head>
<body>
    <!-- Bot iframe -->
    <iframe id="bot-frame" src=""></iframe>

    <!-- Loading overlay -->
    <div id="loading-overlay">
        <div class="spinner"></div>
        <p data-i18n="loading">èª­ã¿è¾¼ã¿ä¸­...</p>
    </div>

    <!-- Floating overlay panel -->
    <div id="kiosk-overlay">
        <div id="kiosk-header">
            <div>
                <h1>ğŸ¤– <span data-i18n="title">AIã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥</span></h1>
                <p>ãƒ‹ãƒ¥ã‚¦ãƒãƒ³é«˜è¼ª</p>
            </div>
            <select id="lang-selector">
                <option value="ja">ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª</option>
                <option value="en">ğŸ‡ºğŸ‡¸ English</option>
                <option value="zh">ğŸ‡¨ğŸ‡³ ä¸­æ–‡</option>
                <option value="ko">ğŸ‡°ğŸ‡· í•œêµ­ì–´</option>
                <option value="vi">ğŸ‡»ğŸ‡³ Tiáº¿ng Viá»‡t</option>
                <option value="pt">ğŸ‡µğŸ‡¹ PortuguÃªs</option>
                <option value="pt-br">ğŸ‡§ğŸ‡· PortuguÃªs BR</option>
                <option value="id">ğŸ‡®ğŸ‡© Indonesia</option>
                <option value="ne">ğŸ‡³ğŸ‡µ à¤¨à¥‡à¤ªà¤¾à¤²à¥€</option>
                <option value="es">ğŸ‡ªğŸ‡¸ EspaÃ±ol</option>
            </select>
            <a id="back-btn" href="index.html" data-i18n="back">â† æˆ»ã‚‹</a>
        </div>
        <div id="kiosk-zones"></div>
        <div id="kiosk-prompts"></div>
        <div id="kiosk-footer">
            <div id="kiosk-hint">
                <span class="icon">ğŸ‘†</span> <span data-i18n="hint">ã‚¿ãƒƒãƒ—ã§ã‚³ãƒ”ãƒ¼ â†’ è²¼ã‚Šä»˜ã‘ã¦é€ä¿¡</span>
            </div>
            <div id="kiosk-status">Bot Share Mode</div>
        </div>
    </div>

    <!-- Toggle button - desktop (shown when overlay is hidden) -->
    <button id="kiosk-toggle-btn">â˜°</button>

    <!-- Mobile peek tab - minimal handle -->
    <button id="kiosk-peek-tab">
        <span class="handle"></span>
    </button>

    <!-- Toast notification -->
    <div id="toast">
        <span>ğŸ“‹</span>
        <span id="toast-text">ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼</span>
    </div>

    <script>
        // Configuration
        var CONFIG = {
            botBaseUrl: 'https://gbase.ai/bot/a182ac3e-0552-4fc0-aced-cd995e5f91c2',
            realtimeBaseUrl: 'https://gbase.ai/realtime/a182ac3e-0552-4fc0-aced-cd995e5f91c2'
        };

        // Current language
        var currentLang = 'ja';

        // Translations
        var TRANSLATIONS = {
            ja: {
                title: 'AIã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥',
                back: 'â† æˆ»ã‚‹',
                loading: 'èª­ã¿è¾¼ã¿ä¸­...',
                hint: 'ã‚¿ãƒƒãƒ—ã§ã‚³ãƒ”ãƒ¼ â†’ è²¼ã‚Šä»˜ã‘ã¦é€ä¿¡',
                copied: 'ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼',
                realtimeStart: 'ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¼šè©±ã‚’é–‹å§‹',
                zones: ['ç·åˆæ¡ˆå†…', 'ãƒ•ãƒ­ã‚¢ãƒŠãƒ“', 'åº—èˆ—æ¤œç´¢', 'å¤šè¨€èª', 'ãã®ä»–', 'ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¼šè©±'],
                prompts: [
                    ['å–¶æ¥­æ™‚é–“ã‚’æ•™ãˆã¦', 'ä»Šæ—¥ã®ã‚¤ãƒ™ãƒ³ãƒˆã¯ï¼Ÿ', 'é§è»Šå ´ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ', 'ãƒ™ãƒ“ãƒ¼ã‚«ãƒ¼ã‚’å€Ÿã‚ŠãŸã„'],
                    ['ã‚¹ã‚¿ãƒ¼ãƒãƒƒã‚¯ã‚¹ã¯ã©ã“ï¼Ÿ', 'ãƒˆã‚¤ãƒ¬ã«è¡ŒããŸã„', 'ATMã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ', 'ãƒ¦ãƒ‹ã‚¯ãƒ­ã¸ã®è¡Œãæ–¹'],
                    ['ã‚«ãƒ•ã‚§ã‚’æ¢ã—ã¦', 'ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã®ãŠã™ã™ã‚', 'å­ä¾›æœã®ãŠåº—', 'ãŠåœŸç”£ã‚’è²·ã„ãŸã„'],
                    ['Where is the restroom?', 'å…ç¨æŸœå°åœ¨å“ªé‡Œï¼Ÿ', 'í™”ì¥ì‹¤ì´ ì–´ë””ì—ìš”?', 'à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?'],
                    ['Wi-Fiã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ', 'ã‚³ã‚¤ãƒ³ãƒ­ãƒƒã‚«ãƒ¼ã®å ´æ‰€', 'è»Šæ¤…å­ã®è²¸ã—å‡ºã—', 'å¿˜ã‚Œç‰©ã‚’ã—ã¾ã—ãŸ'],
                    []
                ]
            },
            en: {
                title: 'AI Concierge',
                back: 'â† Back',
                loading: 'Loading...',
                hint: 'Tap to copy â†’ Paste and send',
                copied: 'Copied!',
                realtimeStart: 'Start Realtime Conversation',
                zones: ['General Info', 'Floor Guide', 'Shop Search', 'Multilingual', 'Others', 'Realtime Chat'],
                prompts: [
                    ['What are the opening hours?', 'Any events today?', 'Is there parking?', 'Can I borrow a stroller?'],
                    ['Where is Starbucks?', 'Where is the restroom?', 'Is there an ATM?', 'How to get to Uniqlo?'],
                    ['Find a cafe', 'Restaurant recommendations', 'Kids clothing stores', 'I want to buy souvenirs'],
                    ['Where is the restroom?', 'å…ç¨æŸœå°åœ¨å“ªé‡Œï¼Ÿ', 'í™”ì¥ì‹¤ì´ ì–´ë””ì—ìš”?', 'à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?'],
                    ['Is there Wi-Fi?', 'Where are the lockers?', 'Wheelchair rental', 'I lost something'],
                    []
                ]
            },
            zh: {
                title: 'AIç¤¼å®¾æœåŠ¡',
                back: 'â† è¿”å›',
                loading: 'åŠ è½½ä¸­...',
                hint: 'ç‚¹å‡»å¤åˆ¶ â†’ ç²˜è´´å¹¶å‘é€',
                copied: 'å·²å¤åˆ¶ï¼',
                realtimeStart: 'å¼€å§‹å®æ—¶å¯¹è¯',
                zones: ['ç»¼åˆå’¨è¯¢', 'æ¥¼å±‚å¯¼èˆª', 'åº—é“ºæœç´¢', 'å¤šè¯­è¨€', 'å…¶ä»–', 'å®æ—¶å¯¹è¯'],
                prompts: [
                    ['è¥ä¸šæ—¶é—´æ˜¯å‡ ç‚¹ï¼Ÿ', 'ä»Šå¤©æœ‰ä»€ä¹ˆæ´»åŠ¨ï¼Ÿ', 'æœ‰åœè½¦åœºå—ï¼Ÿ', 'å¯ä»¥å€Ÿå©´å„¿è½¦å—ï¼Ÿ'],
                    ['æ˜Ÿå·´å…‹åœ¨å“ªé‡Œï¼Ÿ', 'æ´—æ‰‹é—´åœ¨å“ªé‡Œï¼Ÿ', 'æœ‰ATMå—ï¼Ÿ', 'ä¼˜è¡£åº“æ€ä¹ˆèµ°ï¼Ÿ'],
                    ['æ‰¾å’–å•¡å…', 'æ¨èé¤å…', 'ç«¥è£…åº—', 'æƒ³ä¹°çºªå¿µå“'],
                    ['Where is the restroom?', 'å…ç¨æŸœå°åœ¨å“ªé‡Œï¼Ÿ', 'í™”ì¥ì‹¤ì´ ì–´ë””ì—ìš”?', 'à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?'],
                    ['æœ‰Wi-Fiå—ï¼Ÿ', 'å‚¨ç‰©æŸœåœ¨å“ªï¼Ÿ', 'è½®æ¤…ç§Ÿå€Ÿ', 'æˆ‘ä¸¢ä¸œè¥¿äº†'],
                    []
                ]
            },
            ko: {
                title: 'AI ì»¨ì‹œì–´ì§€',
                back: 'â† ë’¤ë¡œ',
                loading: 'ë¡œë”© ì¤‘...',
                hint: 'íƒ­í•˜ì—¬ ë³µì‚¬ â†’ ë¶™ì—¬ë„£ê¸°í•˜ì—¬ ì „ì†¡',
                copied: 'ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!',
                realtimeStart: 'ì‹¤ì‹œê°„ ëŒ€í™” ì‹œì‘',
                zones: ['ì¢…í•© ì•ˆë‚´', 'í”Œë¡œì–´ ê°€ì´ë“œ', 'ë§¤ì¥ ê²€ìƒ‰', 'ë‹¤êµ­ì–´', 'ê¸°íƒ€', 'ì‹¤ì‹œê°„ ëŒ€í™”'],
                prompts: [
                    ['ì˜ì—…ì‹œê°„ì´ ì–´ë–»ê²Œ ë˜ë‚˜ìš”?', 'ì˜¤ëŠ˜ ì´ë²¤íŠ¸ê°€ ìˆë‚˜ìš”?', 'ì£¼ì°¨ì¥ì´ ìˆë‚˜ìš”?', 'ìœ ëª¨ì°¨ë¥¼ ë¹Œë¦´ ìˆ˜ ìˆë‚˜ìš”?'],
                    ['ìŠ¤íƒ€ë²…ìŠ¤ëŠ” ì–´ë””ì¸ê°€ìš”?', 'í™”ì¥ì‹¤ì€ ì–´ë””ì¸ê°€ìš”?', 'ATMì´ ìˆë‚˜ìš”?', 'ìœ ë‹ˆí´ë¡œëŠ” ì–´ë–»ê²Œ ê°€ë‚˜ìš”?'],
                    ['ì¹´í˜ë¥¼ ì°¾ì•„ì£¼ì„¸ìš”', 'ë ˆìŠ¤í† ë‘ ì¶”ì²œ', 'ì•„ë™ë³µ ë§¤ì¥', 'ê¸°ë…í’ˆì„ ì‚¬ê³  ì‹¶ì–´ìš”'],
                    ['Where is the restroom?', 'å…ç¨æŸœå°åœ¨å“ªé‡Œï¼Ÿ', 'í™”ì¥ì‹¤ì´ ì–´ë””ì—ìš”?', 'à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?'],
                    ['Wi-Fiê°€ ìˆë‚˜ìš”?', 'ë¬¼í’ˆë³´ê´€í•¨ì€ ì–´ë””ì¸ê°€ìš”?', 'íœ ì²´ì–´ ëŒ€ì—¬', 'ë¶„ì‹¤ë¬¼ì´ ìˆì–´ìš”'],
                    []
                ]
            },
            vi: {
                title: 'Trá»£ lÃ½ AI',
                back: 'â† Quay láº¡i',
                loading: 'Äang táº£i...',
                hint: 'Nháº¥n Ä‘á»ƒ sao chÃ©p â†’ DÃ¡n vÃ  gá»­i',
                copied: 'ÄÃ£ sao chÃ©p!',
                realtimeStart: 'Báº¯t Ä‘áº§u há»™i thoáº¡i',
                zones: ['ThÃ´ng tin chung', 'HÆ°á»›ng dáº«n táº§ng', 'TÃ¬m cá»­a hÃ ng', 'Äa ngÃ´n ngá»¯', 'KhÃ¡c', 'TrÃ² chuyá»‡n trá»±c tiáº¿p'],
                prompts: [
                    ['Giá» má»Ÿ cá»­a lÃ  máº¥y giá»?', 'HÃ´m nay cÃ³ sá»± kiá»‡n gÃ¬?', 'CÃ³ bÃ£i Ä‘á»— xe khÃ´ng?', 'TÃ´i cÃ³ thá»ƒ mÆ°á»£n xe Ä‘áº©y khÃ´ng?'],
                    ['Starbucks á»Ÿ Ä‘Ã¢u?', 'NhÃ  vá»‡ sinh á»Ÿ Ä‘Ã¢u?', 'CÃ³ ATM khÃ´ng?', 'ÄÆ°á»ng Ä‘áº¿n Uniqlo?'],
                    ['TÃ¬m quÃ¡n cÃ  phÃª', 'Gá»£i Ã½ nhÃ  hÃ ng', 'Cá»­a hÃ ng quáº§n Ã¡o tráº» em', 'TÃ´i muá»‘n mua quÃ  lÆ°u niá»‡m'],
                    ['Where is the restroom?', 'å…ç¨æŸœå°åœ¨å“ªé‡Œï¼Ÿ', 'í™”ì¥ì‹¤ì´ ì–´ë””ì—ìš”?', 'à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?'],
                    ['CÃ³ Wi-Fi khÃ´ng?', 'Tá»§ khÃ³a á»Ÿ Ä‘Ã¢u?', 'ThuÃª xe lÄƒn', 'TÃ´i bá»‹ máº¥t Ä‘á»“'],
                    []
                ]
            },
            pt: {
                title: 'Concierge IA',
                back: 'â† Voltar',
                loading: 'Carregando...',
                hint: 'Toque para copiar â†’ Cole e envie',
                copied: 'Copiado!',
                realtimeStart: 'Iniciar Conversa',
                zones: ['InformaÃ§Ãµes', 'Guia de Andares', 'Buscar Lojas', 'MultilÃ­ngue', 'Outros', 'Chat em Tempo Real'],
                prompts: [
                    ['Qual o horÃ¡rio de funcionamento?', 'HÃ¡ eventos hoje?', 'Tem estacionamento?', 'Posso pegar um carrinho?'],
                    ['Onde fica o Starbucks?', 'Onde Ã© o banheiro?', 'Tem caixa eletrÃ´nico?', 'Como chego na Uniqlo?'],
                    ['Procurar um cafÃ©', 'RecomendaÃ§Ãµes de restaurantes', 'Lojas de roupas infantis', 'Quero comprar lembranÃ§as'],
                    ['Where is the restroom?', 'å…ç¨æŸœå°åœ¨å“ªé‡Œï¼Ÿ', 'í™”ì¥ì‹¤ì´ ì–´ë””ì—ìš”?', 'à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?'],
                    ['Tem Wi-Fi?', 'Onde ficam os armÃ¡rios?', 'Aluguel de cadeira de rodas', 'Perdi algo'],
                    []
                ]
            },
            'pt-br': {
                title: 'Concierge IA',
                back: 'â† Voltar',
                loading: 'Carregando...',
                hint: 'Toque para copiar â†’ Cole e envie',
                copied: 'Copiado!',
                realtimeStart: 'Iniciar Conversa',
                zones: ['InformaÃ§Ãµes', 'Guia de Andares', 'Buscar Lojas', 'MultilÃ­ngue', 'Outros', 'Chat em Tempo Real'],
                prompts: [
                    ['Qual o horÃ¡rio de funcionamento?', 'Tem eventos hoje?', 'Tem estacionamento?', 'Posso pegar um carrinho?'],
                    ['Onde fica o Starbucks?', 'Onde Ã© o banheiro?', 'Tem caixa eletrÃ´nico?', 'Como chego na Uniqlo?'],
                    ['Procurar um cafÃ©', 'RecomendaÃ§Ãµes de restaurantes', 'Lojas de roupas infantis', 'Quero comprar lembranÃ§as'],
                    ['Where is the restroom?', 'å…ç¨æŸœå°åœ¨å“ªé‡Œï¼Ÿ', 'í™”ì¥ì‹¤ì´ ì–´ë””ì—ìš”?', 'à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?'],
                    ['Tem Wi-Fi?', 'Onde ficam os armÃ¡rios?', 'Aluguel de cadeira de rodas', 'Perdi algo'],
                    []
                ]
            },
            id: {
                title: 'Asisten AI',
                back: 'â† Kembali',
                loading: 'Memuat...',
                hint: 'Ketuk untuk menyalin â†’ Tempel dan kirim',
                copied: 'Tersalin!',
                realtimeStart: 'Mulai Percakapan',
                zones: ['Info Umum', 'Panduan Lantai', 'Cari Toko', 'Multibahasa', 'Lainnya', 'Obrolan Langsung'],
                prompts: [
                    ['Jam operasional?', 'Ada acara hari ini?', 'Ada parkir?', 'Bisa pinjam stroller?'],
                    ['Starbucks di mana?', 'Toilet di mana?', 'Ada ATM?', 'Cara ke Uniqlo?'],
                    ['Cari kafe', 'Rekomendasi restoran', 'Toko baju anak', 'Mau beli oleh-oleh'],
                    ['Where is the restroom?', 'å…ç¨æŸœå°åœ¨å“ªé‡Œï¼Ÿ', 'í™”ì¥ì‹¤ì´ ì–´ë””ì—ìš”?', 'à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?'],
                    ['Ada Wi-Fi?', 'Loker di mana?', 'Sewa kursi roda', 'Saya kehilangan barang'],
                    []
                ]
            },
            ne: {
                title: 'AI à¤¸à¤¹à¤¾à¤¯à¤•',
                back: 'â† à¤ªà¤›à¤¾à¤¡à¤¿',
                loading: 'à¤²à¥‹à¤¡ à¤¹à¥à¤à¤¦à¥ˆà¤›...',
                hint: 'à¤ªà¥à¤°à¤¤à¤¿à¤²à¤¿à¤ªà¤¿ à¤—à¤°à¥à¤¨ à¤Ÿà¥à¤¯à¤¾à¤ª à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥ â†’ à¤Ÿà¤¾à¤à¤¸à¥à¤¨à¥à¤¹à¥‹à¤¸à¥ à¤° à¤ªà¤ à¤¾à¤‰à¤¨à¥à¤¹à¥‹à¤¸à¥',
                copied: 'à¤ªà¥à¤°à¤¤à¤¿à¤²à¤¿à¤ªà¤¿ à¤—à¤°à¤¿à¤¯à¥‹!',
                realtimeStart: 'à¤•à¥à¤°à¤¾à¤•à¤¾à¤¨à¥€ à¤¸à¥à¤°à¥ à¤—à¤°à¥à¤¨à¥à¤¹à¥‹à¤¸à¥',
                zones: ['à¤¸à¤¾à¤®à¤¾à¤¨à¥à¤¯ à¤œà¤¾à¤¨à¤•à¤¾à¤°à¥€', 'à¤¤à¤²à¥à¤²à¤¾ à¤—à¤¾à¤‡à¤¡', 'à¤ªà¤¸à¤² à¤–à¥‹à¤œà¥à¤¨à¥à¤¹à¥‹à¤¸à¥', 'à¤¬à¤¹à¥à¤­à¤¾à¤·à¤¿à¤•', 'à¤…à¤¨à¥à¤¯', 'à¤ªà¥à¤°à¤¤à¥à¤¯à¤•à¥à¤· à¤•à¥à¤°à¤¾à¤•à¤¾à¤¨à¥€'],
                prompts: [
                    ['à¤–à¥à¤²à¥à¤¨à¥‡ à¤¸à¤®à¤¯ à¤•à¥‡ à¤¹à¥‹?', 'à¤†à¤œ à¤•à¥à¤¨à¥ˆ à¤•à¤¾à¤°à¥à¤¯à¤•à¥à¤°à¤® à¤›?', 'à¤ªà¤¾à¤°à¥à¤•à¤¿à¤™ à¤›?', 'à¤•à¥‡ à¤® à¤¸à¥à¤Ÿà¥à¤°à¥‹à¤²à¤° à¤²à¤¿à¤¨ à¤¸à¤•à¥à¤›à¥?'],
                    ['Starbucks à¤•à¤¹à¤¾à¤ à¤›?', 'à¤¶à¥Œà¤šà¤¾à¤²à¤¯ à¤•à¤¹à¤¾à¤ à¤›?', 'ATM à¤›?', 'Uniqlo à¤•à¤¸à¤°à¥€ à¤œà¤¾à¤¨à¥‡?'],
                    ['à¤•à¥à¤¯à¤¾à¤«à¥‡ à¤–à¥‹à¤œà¥à¤¨à¥à¤¹à¥‹à¤¸à¥', 'à¤°à¥‡à¤¸à¥à¤Ÿà¥à¤°à¥‡à¤¨à¥à¤Ÿ à¤¸à¤¿à¤«à¤¾à¤°à¤¿à¤¸à¤¹à¤°à¥‚', 'à¤¬à¤šà¥à¤šà¤¾à¤•à¥‹ à¤²à¥à¤—à¤¾ à¤ªà¤¸à¤²à¤¹à¤°à¥‚', 'à¤® à¤‰à¤ªà¤¹à¤¾à¤° à¤•à¤¿à¤¨à¥à¤¨ à¤šà¤¾à¤¹à¤¨à¥à¤›à¥'],
                    ['Where is the restroom?', 'å…ç¨æŸœå°åœ¨å“ªé‡Œï¼Ÿ', 'í™”ì¥ì‹¤ì´ ì–´ë””ì—ìš”?', 'à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?'],
                    ['Wi-Fi à¤›?', 'à¤²à¤•à¤° à¤•à¤¹à¤¾à¤ à¤›?', 'à¤µà¥à¤¹à¥€à¤²à¤šà¥‡à¤¯à¤° à¤­à¤¾à¤¡à¤¾à¤®à¤¾', 'à¤®à¥ˆà¤²à¥‡ à¤•à¥‡à¤¹à¥€ à¤¹à¤°à¤¾à¤¯à¥‹'],
                    []
                ]
            },
            es: {
                title: 'Conserje IA',
                back: 'â† Volver',
                loading: 'Cargando...',
                hint: 'Toca para copiar â†’ Pega y envÃ­a',
                copied: 'Â¡Copiado!',
                realtimeStart: 'Iniciar ConversaciÃ³n',
                zones: ['Info General', 'GuÃ­a de Pisos', 'Buscar Tiendas', 'MultilingÃ¼e', 'Otros', 'Chat en Vivo'],
                prompts: [
                    ['Â¿CuÃ¡l es el horario?', 'Â¿Hay eventos hoy?', 'Â¿Hay estacionamiento?', 'Â¿Puedo usar un cochecito?'],
                    ['Â¿DÃ³nde estÃ¡ Starbucks?', 'Â¿DÃ³nde estÃ¡ el baÃ±o?', 'Â¿Hay cajero automÃ¡tico?', 'Â¿CÃ³mo llego a Uniqlo?'],
                    ['Buscar una cafeterÃ­a', 'Recomendaciones de restaurantes', 'Tiendas de ropa infantil', 'Quiero comprar recuerdos'],
                    ['Where is the restroom?', 'å…ç¨æŸœå°åœ¨å“ªé‡Œï¼Ÿ', 'í™”ì¥ì‹¤ì´ ì–´ë””ì—ìš”?', 'à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™?'],
                    ['Â¿Hay Wi-Fi?', 'Â¿DÃ³nde estÃ¡n los casilleros?', 'Alquiler de silla de ruedas', 'PerdÃ­ algo'],
                    []
                ]
            }
        };

        // Get ZONES for current language
        function getZones() {
            var t = TRANSLATIONS[currentLang] || TRANSLATIONS.ja;
            return [
                { icon: 'ğŸ«', label: t.zones[0], color: '#3b82f6', prompts: t.prompts[0] },
                { icon: 'ğŸ—ºï¸', label: t.zones[1], color: '#f97316', prompts: t.prompts[1] },
                { icon: 'ğŸ›ï¸', label: t.zones[2], color: '#ec4899', prompts: t.prompts[2] },
                { icon: 'ğŸŒ', label: t.zones[3], color: '#22c55e', prompts: t.prompts[3] },
                { icon: 'â“', label: t.zones[4], color: '#8b5cf6', prompts: t.prompts[4] },
                { icon: 'ğŸ¤', label: t.zones[5], color: '#a855f7', isRealtime: true, realtimeUrl: CONFIG.realtimeBaseUrl + '?lang=' + currentLang, prompts: t.prompts[5] }
            ];
        }

        var currentZoneIndex = 0;

        // Get language from URL parameter
        function getInitialLang() {
            var params = new URLSearchParams(window.location.search);
            var lang = params.get('lang');
            if (lang && TRANSLATIONS[lang]) {
                return lang;
            }
            return 'ja';
        }

        // Get zone from URL parameter
        function getInitialZone() {
            var params = new URLSearchParams(window.location.search);
            var zone = params.get('zone');
            var zones = getZones();
            if (zone !== null) {
                var zoneIndex = parseInt(zone, 10);
                if (zoneIndex >= 0 && zoneIndex < zones.length) {
                    return zoneIndex;
                }
            }
            return 0;
        }

        // Apply translations to UI
        function applyTranslations() {
            var t = TRANSLATIONS[currentLang] || TRANSLATIONS.ja;
            document.querySelectorAll('[data-i18n]').forEach(function(el) {
                var key = el.getAttribute('data-i18n');
                if (t[key]) {
                    el.textContent = t[key];
                }
            });
        }

        // Change language
        function changeLanguage(lang) {
            if (!TRANSLATIONS[lang]) return;
            currentLang = lang;
            applyTranslations();
            initZones();
            renderPrompts(currentZoneIndex);
            loadBot();

            // Update URL without reload
            var url = new URL(window.location.href);
            url.searchParams.set('lang', lang);
            window.history.replaceState({}, '', url);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            currentLang = getInitialLang();
            var langSelector = document.getElementById('lang-selector');
            if (langSelector) {
                langSelector.value = currentLang;
                langSelector.addEventListener('change', function() {
                    changeLanguage(this.value);
                });
            }
            applyTranslations();
            var initialZone = getInitialZone();
            currentZoneIndex = initialZone;
            initZones();
            renderPrompts(initialZone);
            loadBot();
            setupEventListeners();
        });

        // Load bot iframe
        function loadBot() {
            var iframe = document.getElementById('bot-frame');
            var loading = document.getElementById('loading-overlay');

            iframe.src = CONFIG.botBaseUrl + '?lang=' + currentLang;

            iframe.onload = function() {
                setTimeout(function() {
                    loading.classList.add('hidden');
                }, 1000);
            };

            // Fallback timeout
            setTimeout(function() {
                loading.classList.add('hidden');
            }, 5000);
        }

        // Initialize zone buttons using safe DOM methods
        function initZones() {
            var container = document.getElementById('kiosk-zones');
            container.textContent = '';
            var zones = getZones();

            zones.forEach(function(zone, index) {
                var btn = document.createElement('button');
                btn.className = 'kiosk-zone-btn' + (index === currentZoneIndex ? ' active' : '');
                btn.style.setProperty('--zone-color', zone.color);

                var iconSpan = document.createElement('span');
                iconSpan.className = 'zone-icon';
                iconSpan.textContent = zone.icon;

                var labelSpan = document.createElement('span');
                labelSpan.className = 'zone-label';
                labelSpan.textContent = zone.label;

                btn.appendChild(iconSpan);
                btn.appendChild(labelSpan);

                btn.onclick = function(e) {
                    e.stopPropagation();
                    selectZone(index);
                };
                container.appendChild(btn);
            });
        }

        // Select zone
        function selectZone(index) {
            currentZoneIndex = index;

            // Update active state
            var buttons = document.querySelectorAll('.kiosk-zone-btn');
            buttons.forEach(function(btn, i) {
                if (i === index) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });

            renderPrompts(index);
        }

        // Render prompts for zone using safe DOM methods
        function renderPrompts(zoneIndex) {
            var zones = getZones();
            var zone = zones[zoneIndex];
            var t = TRANSLATIONS[currentLang] || TRANSLATIONS.ja;
            var container = document.getElementById('kiosk-prompts');
            container.textContent = '';
            container.style.setProperty('--zone-color', zone.color);

            // Special handling for realtime zone
            if (zone.isRealtime) {
                var realtimeBtn = document.createElement('a');
                realtimeBtn.href = zone.realtimeUrl;
                realtimeBtn.target = '_blank';
                realtimeBtn.className = 'kiosk-prompt-btn realtime-btn';
                realtimeBtn.style.setProperty('--zone-color', zone.color);
                realtimeBtn.style.background = 'linear-gradient(135deg, #a855f7 0%, #9333ea 100%)';
                realtimeBtn.style.border = 'none';
                realtimeBtn.style.textDecoration = 'none';
                realtimeBtn.style.justifyContent = 'center';
                realtimeBtn.style.padding = '16px';
                realtimeBtn.style.fontSize = '14px';

                var iconSpan = document.createElement('span');
                iconSpan.textContent = 'ğŸ¤ ';

                var textSpan = document.createElement('span');
                textSpan.textContent = t.realtimeStart;

                realtimeBtn.appendChild(iconSpan);
                realtimeBtn.appendChild(textSpan);

                realtimeBtn.onclick = function() {
                    setTimeout(function() { hideOverlay(); }, 300);
                };
                container.appendChild(realtimeBtn);
                return;
            }

            zone.prompts.forEach(function(prompt) {
                var btn = document.createElement('button');
                btn.className = 'kiosk-prompt-btn';
                btn.style.setProperty('--zone-color', zone.color);

                var textSpan = document.createElement('span');
                textSpan.textContent = prompt;

                var arrowSpan = document.createElement('span');
                arrowSpan.className = 'arrow';
                arrowSpan.textContent = 'â†’';

                btn.appendChild(textSpan);
                btn.appendChild(arrowSpan);

                btn.onclick = function() {
                    sendPrompt(prompt, btn);
                };
                container.appendChild(btn);
            });
        }

        // Copy prompt to clipboard
        function sendPrompt(prompt, btn) {
            var t = TRANSLATIONS[currentLang] || TRANSLATIONS.ja;
            btn.classList.add('copied');
            var arrow = btn.querySelector('.arrow');
            if (arrow) arrow.textContent = 'â³';

            navigator.clipboard.writeText(prompt).then(function() {
                if (arrow) arrow.textContent = 'âœ“';
                showToast(t.copied);

                // Auto-hide overlay after copying
                setTimeout(function() {
                    hideOverlay();
                }, 800);
            }).catch(function() {
                if (arrow) arrow.textContent = 'âœ—';
                showToast('Error');
            });

            setTimeout(function() {
                btn.classList.remove('copied');
                if (arrow) arrow.textContent = 'â†’';
            }, 2000);
        }

        // Show toast notification
        function showToast(message) {
            var toast = document.getElementById('toast');
            var text = document.getElementById('toast-text');
            text.textContent = message;
            toast.classList.add('show');

            setTimeout(function() {
                toast.classList.remove('show');
            }, 3000);
        }

        // Setup event listeners
        function setupEventListeners() {
            var overlay = document.getElementById('kiosk-overlay');
            var toggleBtn = document.getElementById('kiosk-toggle-btn');
            var peekTab = document.getElementById('kiosk-peek-tab');
            var header = document.getElementById('kiosk-header');

            // Toggle button click (desktop)
            toggleBtn.onclick = function() {
                showOverlay();
            };

            // Peek tab click (mobile)
            peekTab.onclick = function() {
                showOverlay();
            };

            // Click outside to close
            document.addEventListener('click', function(e) {
                if (!overlay.classList.contains('hidden')) {
                    if (!overlay.contains(e.target) && e.target !== toggleBtn && e.target !== peekTab) {
                        hideOverlay();
                    }
                }
            });

            // Prevent clicks inside overlay from closing it
            overlay.addEventListener('click', function(e) {
                e.stopPropagation();
            });

            // Touch swipe to close (mobile)
            var touchStartY = 0;
            var touchCurrentY = 0;

            header.addEventListener('touchstart', function(e) {
                touchStartY = e.touches[0].clientY;
            }, { passive: true });

            header.addEventListener('touchmove', function(e) {
                touchCurrentY = e.touches[0].clientY;
                var diff = touchCurrentY - touchStartY;
                if (diff > 0) {
                    overlay.style.transform = 'translateY(' + diff + 'px)';
                }
            }, { passive: true });

            header.addEventListener('touchend', function(e) {
                var diff = touchCurrentY - touchStartY;
                overlay.style.transform = '';
                if (diff > 50) {
                    hideOverlay();
                }
                touchStartY = 0;
                touchCurrentY = 0;
            }, { passive: true });
        }

        // Show overlay
        function showOverlay() {
            document.getElementById('kiosk-overlay').classList.remove('hidden');
            document.getElementById('kiosk-toggle-btn').classList.remove('visible');
            document.getElementById('kiosk-peek-tab').classList.remove('visible');
        }

        // Hide overlay
        function hideOverlay() {
            document.getElementById('kiosk-overlay').classList.add('hidden');
            document.getElementById('kiosk-toggle-btn').classList.add('visible');
            document.getElementById('kiosk-peek-tab').classList.add('visible');
        }
    </script>
</body>
</html>
